export interface WordGeneratorOptions {
  count: number;
  includeNumbers?: boolean;
  includePunctuation?: boolean;
  includeSpecialCharacters?: boolean;
}

// Top 1000 most common English words - curated for typing practice
const commonWords = [
  // Articles & Determiners
  "the",
  "a",
  "an",
  "this",
  "that",
  "these",
  "those",
  "my",
  "your",
  "his",
  "her",
  "its",
  "our",
  "their",
  "some",
  "any",
  "no",
  "every",
  "each",
  "all",
  "both",
  "few",
  "more",
  "most",
  "other",
  "such",
  "what",
  "which",
  "whose",

  // Pronouns
  "i",
  "you",
  "he",
  "she",
  "it",
  "we",
  "they",
  "me",
  "him",
  "us",
  "them",
  "myself",
  "yourself",
  "himself",
  "herself",
  "itself",
  "ourselves",
  "themselves",
  "who",
  "whom",
  "whoever",
  "whatever",
  "whichever",

  // Common Verbs
  "be",
  "is",
  "am",
  "are",
  "was",
  "were",
  "been",
  "being",
  "have",
  "has",
  "had",
  "having",
  "do",
  "does",
  "did",
  "doing",
  "done",
  "say",
  "said",
  "says",
  "saying",
  "get",
  "gets",
  "got",
  "getting",
  "gotten",
  "make",
  "makes",
  "made",
  "making",
  "go",
  "goes",
  "went",
  "going",
  "gone",
  "know",
  "knows",
  "knew",
  "knowing",
  "known",
  "take",
  "takes",
  "took",
  "taking",
  "taken",
  "see",
  "sees",
  "saw",
  "seeing",
  "seen",
  "come",
  "comes",
  "came",
  "coming",
  "think",
  "thinks",
  "thought",
  "thinking",
  "look",
  "looks",
  "looked",
  "looking",
  "want",
  "wants",
  "wanted",
  "wanting",
  "give",
  "gives",
  "gave",
  "giving",
  "given",
  "use",
  "uses",
  "used",
  "using",
  "find",
  "finds",
  "found",
  "finding",
  "tell",
  "tells",
  "told",
  "telling",
  "ask",
  "asks",
  "asked",
  "asking",
  "work",
  "works",
  "worked",
  "working",
  "seem",
  "seems",
  "seemed",
  "seeming",
  "feel",
  "feels",
  "felt",
  "feeling",
  "try",
  "tries",
  "tried",
  "trying",
  "leave",
  "leaves",
  "left",
  "leaving",
  "call",
  "calls",
  "called",
  "calling",
  "keep",
  "keeps",
  "kept",
  "keeping",
  "let",
  "lets",
  "letting",
  "begin",
  "begins",
  "began",
  "beginning",
  "begun",
  "show",
  "shows",
  "showed",
  "showing",
  "shown",
  "hear",
  "hears",
  "heard",
  "hearing",
  "play",
  "plays",
  "played",
  "playing",
  "run",
  "runs",
  "ran",
  "running",
  "move",
  "moves",
  "moved",
  "moving",
  "live",
  "lives",
  "lived",
  "living",
  "believe",
  "believes",
  "believed",
  "believing",
  "hold",
  "holds",
  "held",
  "holding",
  "bring",
  "brings",
  "brought",
  "bringing",
  "happen",
  "happens",
  "happened",
  "happening",
  "write",
  "writes",
  "wrote",
  "writing",
  "written",
  "provide",
  "provides",
  "provided",
  "providing",
  "sit",
  "sits",
  "sat",
  "sitting",
  "stand",
  "stands",
  "stood",
  "standing",
  "lose",
  "loses",
  "lost",
  "losing",
  "pay",
  "pays",
  "paid",
  "paying",
  "meet",
  "meets",
  "met",
  "meeting",
  "include",
  "includes",
  "included",
  "including",
  "continue",
  "continues",
  "continued",
  "continuing",
  "set",
  "sets",
  "setting",
  "learn",
  "learns",
  "learned",
  "learning",
  "change",
  "changes",
  "changed",
  "changing",
  "lead",
  "leads",
  "led",
  "leading",
  "understand",
  "understands",
  "understood",
  "understanding",
  "watch",
  "watches",
  "watched",
  "watching",
  "follow",
  "follows",
  "followed",
  "following",
  "stop",
  "stops",
  "stopped",
  "stopping",
  "create",
  "creates",
  "created",
  "creating",
  "speak",
  "speaks",
  "spoke",
  "speaking",
  "spoken",
  "read",
  "reads",
  "reading",
  "allow",
  "allows",
  "allowed",
  "allowing",
  "add",
  "adds",
  "added",
  "adding",
  "spend",
  "spends",
  "spent",
  "spending",
  "grow",
  "grows",
  "grew",
  "growing",
  "grown",
  "open",
  "opens",
  "opened",
  "opening",
  "walk",
  "walks",
  "walked",
  "walking",
  "win",
  "wins",
  "won",
  "winning",
  "offer",
  "offers",
  "offered",
  "offering",
  "remember",
  "remembers",
  "remembered",
  "remembering",
  "love",
  "loves",
  "loved",
  "loving",
  "consider",
  "considers",
  "considered",
  "considering",
  "appear",
  "appears",
  "appeared",
  "appearing",
  "buy",
  "buys",
  "bought",
  "buying",
  "wait",
  "waits",
  "waited",
  "waiting",
  "serve",
  "serves",
  "served",
  "serving",
  "die",
  "dies",
  "died",
  "dying",
  "send",
  "sends",
  "sent",
  "sending",
  "expect",
  "expects",
  "expected",
  "expecting",
  "build",
  "builds",
  "built",
  "building",
  "stay",
  "stays",
  "stayed",
  "staying",
  "fall",
  "falls",
  "fell",
  "falling",
  "fallen",
  "cut",
  "cuts",
  "cutting",
  "reach",
  "reaches",
  "reached",
  "reaching",
  "kill",
  "kills",
  "killed",
  "killing",
  "remain",
  "remains",
  "remained",
  "remaining",

  // Common Nouns
  "time",
  "year",
  "people",
  "way",
  "day",
  "man",
  "woman",
  "child",
  "children",
  "world",
  "life",
  "hand",
  "part",
  "place",
  "case",
  "week",
  "company",
  "system",
  "program",
  "question",
  "work",
  "government",
  "number",
  "night",
  "point",
  "home",
  "water",
  "room",
  "mother",
  "area",
  "money",
  "story",
  "fact",
  "month",
  "lot",
  "right",
  "study",
  "book",
  "eye",
  "job",
  "word",
  "business",
  "issue",
  "side",
  "kind",
  "head",
  "house",
  "service",
  "friend",
  "father",
  "power",
  "hour",
  "game",
  "line",
  "end",
  "member",
  "law",
  "car",
  "city",
  "community",
  "name",
  "president",
  "team",
  "minute",
  "idea",
  "kid",
  "body",
  "information",
  "back",
  "parent",
  "face",
  "others",
  "level",
  "office",
  "door",
  "health",
  "person",
  "art",
  "war",
  "history",
  "party",
  "result",
  "change",
  "morning",
  "reason",
  "research",
  "girl",
  "guy",
  "moment",
  "air",
  "teacher",
  "force",
  "education",
  "food",
  "student",
  "group",
  "country",
  "problem",
  "family",
  "school",
  "state",
  "music",
  "market",
  "sense",
  "thing",
  "today",
  "age",
  "policy",
  "process",
  "action",
  "position",
  "love",

  // Technology & Modern
  "computer",
  "software",
  "internet",
  "website",
  "online",
  "digital",
  "technology",
  "email",
  "phone",
  "mobile",
  "application",
  "network",
  "security",
  "password",
  "account",
  "profile",
  "message",
  "video",
  "image",
  "photo",
  "camera",
  "screen",
  "keyboard",
  "mouse",
  "button",
  "click",
  "download",
  "upload",
  "file",
  "folder",
  "document",
  "database",
  "server",
  "cloud",
  "browser",
  "search",
  "link",
  "page",
  "code",
  "programming",
  "developer",
  "design",
  "user",
  "interface",
  "experience",

  // Common Adjectives
  "good",
  "new",
  "first",
  "last",
  "long",
  "great",
  "little",
  "own",
  "other",
  "old",
  "right",
  "big",
  "high",
  "different",
  "small",
  "large",
  "next",
  "early",
  "young",
  "important",
  "few",
  "public",
  "bad",
  "same",
  "able",
  "free",
  "sure",
  "clear",
  "full",
  "special",
  "easy",
  "strong",
  "certain",
  "local",
  "recent",
  "likely",
  "simple",
  "hard",
  "real",
  "best",
  "better",
  "whole",
  "major",
  "open",
  "late",
  "possible",
  "available",
  "main",
  "true",
  "happy",
  "serious",
  "ready",
  "similar",
  "final",
  "natural",
  "nice",
  "beautiful",
  "popular",
  "perfect",

  // Common Adverbs
  "up",
  "so",
  "out",
  "just",
  "now",
  "how",
  "then",
  "more",
  "also",
  "here",
  "well",
  "only",
  "very",
  "even",
  "back",
  "there",
  "down",
  "still",
  "too",
  "really",
  "already",
  "always",
  "never",
  "often",
  "sometimes",
  "usually",
  "probably",
  "actually",
  "quickly",
  "slowly",
  "finally",
  "almost",
  "enough",

  // Prepositions & Conjunctions
  "to",
  "of",
  "in",
  "for",
  "on",
  "with",
  "at",
  "by",
  "from",
  "or",
  "as",
  "but",
  "not",
  "if",
  "about",
  "into",
  "through",
  "after",
  "over",
  "between",
  "out",
  "against",
  "during",
  "without",
  "before",
  "under",
  "around",
  "among",
  "because",
  "although",
  "though",
  "while",
  "since",
  "until",
  "unless",
  "whether",

  // Question Words
  "what",
  "where",
  "when",
  "why",
  "how",
  "which",
  "who",
  "whose",
  "whom",

  // Numbers as Words
  "one",
  "two",
  "three",
  "four",
  "five",
  "six",
  "seven",
  "eight",
  "nine",
  "ten",
  "eleven",
  "twelve",
  "twenty",
  "thirty",
  "hundred",
  "thousand",
  "million",
  "first",
  "second",
  "third",
  "fourth",
  "fifth",
];

// Natural phrases with numbers (for number mode)
const numberPhrases = [
  "page 1",
  "step 2",
  "item 3",
  "level 4",
  "chapter 5",
  "version 2.0",
  "model 3",
  "room 101",
  "route 66",
  "24 hours",
  "365 days",
  "100 percent",
  "50 states",
  "12 months",
  "7 days",
  "1st place",
  "2nd floor",
  "3rd time",
  "4th quarter",
  "5th avenue",
  "top 10",
  "24/7",
  "9 to 5",
  "3.14",
  "99.9%",
];

// Words that naturally have punctuation
const contractions = [
  "don't",
  "can't",
  "won't",
  "shouldn't",
  "couldn't",
  "wouldn't",
  "didn't",
  "isn't",
  "aren't",
  "wasn't",
  "weren't",
  "hasn't",
  "haven't",
  "hadn't",
  "it's",
  "that's",
  "what's",
  "there's",
  "here's",
  "who's",
  "let's",
  "I'm",
  "you're",
  "we're",
  "they're",
  "I've",
  "you've",
  "we've",
  "they've",
  "I'll",
  "you'll",
  "we'll",
  "they'll",
  "I'd",
  "you'd",
  "we'd",
  "they'd",
];

// Special characters for typing practice
const specialCharacters = [
  "@",
  "#",
  "$",
  "%",
  "^",
  "&",
  "*",
  "(",
  ")",
  "_",
  "+",
  "=",
  "[",
  "]",
  "{",
  "}",
  "|",
  "\\",
  "/",
  "<",
  ">",
  "~",
  "`",
];

// Natural phrases with special characters
const specialCharacterPhrases = [
  "user@email",
  "#hashtag",
  "$100",
  "50%",
  "Q&A",
  "rock&roll",
  "C++",
  "node.js",
  "test_case",
  "my_variable",
  "src/index",
  "path/to/file",
  "{object}",
  "[array]",
  "(group)",
  "key=value",
  "a+b",
  "x*y",
  "user|admin",
  "~home",
  "cmd>output",
  "input<file",
  "code`block`",
  "a^2",
  "c:\\users",
  "path\\file",
];

function shuffle<T>(array: T[]): T[] {
  const result = [...array];
  for (let i = result.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [result[i], result[j]] = [result[j], result[i]];
  }
  return result;
}

function pick<T>(array: T[]): T {
  return array[Math.floor(Math.random() * array.length)];
}

export function generateWords(options: WordGeneratorOptions): string[] {
  const {
    count,
    includeNumbers = false,
    includePunctuation = false,
    includeSpecialCharacters = false,
  } = options;

  const result: string[] = [];

  // Build the word pool
  let wordPool = [...commonWords];

  if (includePunctuation) {
    // Add contractions for more natural punctuation
    wordPool = [...wordPool, ...contractions];
  }

  const shuffledPool = shuffle(wordPool);
  let poolIndex = 0;

  for (let i = 0; i < count; i++) {
    // Occasionally insert number phrases (about 5% of words when enabled)
    if (includeNumbers && Math.random() < 0.05) {
      const phrase = pick(numberPhrases);
      // Split phrase into individual words and add them
      const phraseWords = phrase.split(" ");
      for (const word of phraseWords) {
        if (result.length < count) {
          result.push(word);
        }
      }
      continue;
    }

    // Occasionally insert special character phrases (about 5% of words when enabled)
    if (includeSpecialCharacters && Math.random() < 0.05) {
      const phrase = pick(specialCharacterPhrases);
      result.push(phrase);
      continue;
    }

    // Get next word from shuffled pool
    let word = shuffledPool[poolIndex % shuffledPool.length];
    poolIndex++;

    // Add natural punctuation
    if (includePunctuation && !contractions.includes(word)) {
      const rand = Math.random();

      // End of sentence (period, question mark, exclamation)
      if (rand < 0.08) {
        const sentenceEnd = Math.random();
        if (sentenceEnd < 0.7) {
          word = word + ".";
        } else if (sentenceEnd < 0.85) {
          word = word + "?";
        } else {
          word = word + "!";
        }
      }
      // Comma
      else if (rand < 0.15) {
        word = word + ",";
      }
      // Semicolon or colon (rare)
      else if (rand < 0.17) {
        word = word + (Math.random() < 0.5 ? ";" : ":");
      }
    }

    // Add special characters to words (about 5% of remaining words when enabled)
    if (includeSpecialCharacters && Math.random() < 0.05) {
      const specialChar = pick(specialCharacters);
      // Randomly prepend or append the special character
      if (Math.random() < 0.5) {
        word = specialChar + word;
      } else {
        word = word + specialChar;
      }
    }

    result.push(word);
  }

  return result.slice(0, count);
}

const wordsExport = { generateWords };
export default wordsExport;
